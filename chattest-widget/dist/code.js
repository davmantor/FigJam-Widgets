(()=>{var Le=Object.defineProperty,Re=Object.defineProperties;var Ue=Object.getOwnPropertyDescriptors;var he=Object.getOwnPropertySymbols;var Ie=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable;var me=(w,s,u)=>s in w?Le(w,s,{enumerable:!0,configurable:!0,writable:!0,value:u}):w[s]=u,x=(w,s)=>{for(var u in s||(s={}))Ie.call(s,u)&&me(w,u,s[u]);if(he)for(var u of he(s))Ae.call(s,u)&&me(w,u,s[u]);return w},k=(w,s)=>Re(w,Ue(s));var N=(w,s,u)=>new Promise(($,H)=>{var V=r=>{try{c(u.next(r))}catch(I){H(I)}},p=r=>{try{c(u.throw(r))}catch(I){H(I)}},c=r=>r.done?$(r.value):Promise.resolve(r.value).then(V,p);c((u=u.apply(w,s)).next())});var{widget:we,showUI:$e,ui:Oe}=figma,{AutoLayout:a,Text:C,useSyncedState:F,Input:Ze,Frame:Qe,Image:Te,SVG:M,useEffect:Ye,colorMapToOptions:Je,usePropertyMenu:qe}=we,Pe='<svg width="32px" height="32px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M20 17V15.8C20 14.1198 20 13.2798 19.673 12.638C19.3854 12.0735 18.9265 11.6146 18.362 11.327C17.7202 11 16.8802 11 15.2 11H4M4 11L8 7M4 11L8 15" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>';var Ve='<svg width="35px" height="35px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#1cb566"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M19.1835 7.80516L16.2188 4.83755C14.1921 2.8089 13.1788 1.79457 12.0904 2.03468C11.0021 2.2748 10.5086 3.62155 9.5217 6.31506L8.85373 8.1381C8.59063 8.85617 8.45908 9.2152 8.22239 9.49292C8.11619 9.61754 7.99536 9.72887 7.86251 9.82451C7.56644 10.0377 7.19811 10.1392 6.46145 10.3423C4.80107 10.8 3.97088 11.0289 3.65804 11.5721C3.5228 11.8069 3.45242 12.0735 3.45413 12.3446C3.45809 12.9715 4.06698 13.581 5.28476 14.8L6.69935 16.2163L2.22345 20.6964C1.92552 20.9946 1.92552 21.4782 2.22345 21.7764C2.52138 22.0746 3.00443 22.0746 3.30236 21.7764L7.77841 17.2961L9.24441 18.7635C10.4699 19.9902 11.0827 20.6036 11.7134 20.6045C11.9792 20.6049 12.2404 20.5358 12.4713 20.4041C13.0192 20.0914 13.2493 19.2551 13.7095 17.5825C13.9119 16.8472 14.013 16.4795 14.2254 16.1835C14.3184 16.054 14.4262 15.9358 14.5468 15.8314C14.8221 15.593 15.1788 15.459 15.8922 15.191L17.7362 14.4981C20.4 13.4973 21.7319 12.9969 21.9667 11.9115C22.2014 10.826 21.1954 9.81905 19.1835 7.80516Z" fill="#1cb566"></path> </g></svg>',ze='<svg fill="#303030" height="18px" width="18px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 492.002 492.002" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M484.136,328.473L264.988,109.329c-5.064-5.064-11.816-7.844-19.172-7.844c-7.208,0-13.964,2.78-19.02,7.844 L7.852,328.265C2.788,333.333,0,340.089,0,347.297c0,7.208,2.784,13.968,7.852,19.032l16.124,16.124 c5.064,5.064,11.824,7.86,19.032,7.86s13.964-2.796,19.032-7.86l183.852-183.852l184.056,184.064 c5.064,5.06,11.82,7.852,19.032,7.852c7.208,0,13.96-2.792,19.028-7.852l16.128-16.132 C494.624,356.041,494.624,338.965,484.136,328.473z"></path> </g> </g> </g></svg>',De='<svg fill="#303030" height="18px" width="18px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 491.996 491.996" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M484.132,124.986l-16.116-16.228c-5.072-5.068-11.82-7.86-19.032-7.86c-7.208,0-13.964,2.792-19.036,7.86l-183.84,183.848 L62.056,108.554c-5.064-5.068-11.82-7.856-19.028-7.856s-13.968,2.788-19.036,7.856l-16.12,16.128 c-10.496,10.488-10.496,27.572,0,38.06l219.136,219.924c5.064,5.064,11.812,8.632,19.084,8.632h0.084 c7.212,0,13.96-3.572,19.024-8.632l218.932-219.328c5.072-5.064,7.856-12.016,7.864-19.224 C491.996,136.902,489.204,130.046,484.132,124.986z"></path> </g> </g> </g></svg>';var Ge='<svg fill="#007AFF" height="18px" width="18px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 492.002 492.002" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M484.136,328.473L264.988,109.329c-5.064-5.064-11.816-7.844-19.172-7.844c-7.208,0-13.964,2.78-19.02,7.844 L7.852,328.265C2.788,333.333,0,340.089,0,347.297c0,7.208,2.784,13.968,7.852,19.032l16.124,16.124 c5.064,5.064,11.824,7.86,19.032,7.86s13.964-2.796,19.032-7.86l183.852-183.852l184.056,184.064 c5.064,5.06,11.82,7.852,19.032,7.852c7.208,0,13.96-2.792,19.028-7.852l16.128-16.132 C494.624,356.041,494.624,338.965,484.136,328.473z"></path> </g> </g> </g></svg>',Ee='<svg fill="#007AFF" height="18px" width="18px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 491.996 491.996" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M484.132,124.986l-16.116-16.228c-5.072-5.068-11.82-7.86-19.032-7.86c-7.208,0-13.964,2.792-19.036,7.86l-183.84,183.848 L62.056,108.554c-5.064-5.068-11.82-7.856-19.028-7.856s-13.968,2.788-19.036,7.856l-16.12,16.128 c-10.496,10.488-10.496,27.572,0,38.06l219.136,219.924c5.064,5.064,11.812,8.632,19.084,8.632h0.084 c7.212,0,13.96-3.572,19.024-8.632l218.932-219.328c5.072-5.064,7.856-12.016,7.864-19.224 C491.996,136.902,489.204,130.046,484.132,124.986z"></path> </g> </g> </g></svg>',ye='<svg width="26px" height="26px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M3 8L4.44293 16.6576C4.76439 18.5863 6.43315 20 8.38851 20H15.6115C17.5668 20 19.2356 18.5863 19.5571 16.6576L21 8M3 8L6.75598 11.0731C7.68373 11.8321 9.06623 11.6102 9.70978 10.5989L12 7M3 8C3.82843 8 4.5 7.32843 4.5 6.5C4.5 5.67157 3.82843 5 3 5C2.17157 5 1.5 5.67157 1.5 6.5C1.5 7.32843 2.17157 8 3 8ZM21 8L17.244 11.0731C16.3163 11.8321 14.9338 11.6102 14.2902 10.5989L12 7M21 8C21.8284 8 22.5 7.32843 22.5 6.5C22.5 5.67157 21.8284 5 21 5C20.1716 5 19.5 5.67157 19.5 6.5C19.5 7.32843 20.1716 8 21 8ZM12 7C12.8284 7 13.5 6.32843 13.5 5.5C13.5 4.67157 12.8284 4 12 4C11.1716 4 10.5 4.67157 10.5 5.5C10.5 6.32843 11.1716 7 12 7Z" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>',He='<svg width="28px" height="28px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M4 12H20M12 4V20" stroke="#ffffff" stroke-width="3.0" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>';function We(){let[w,s]=F("newMessage",Date.now()),[u,$]=F("newMessage",""),[H,V]=F("replyToId",null),[p,c]=F("messages",[]),[r,I]=F("userName","Unknown User"),[z,ie]=F("inputPlaceholder","Type a message..."),[ne,O]=F("inputActive",!1),[se,le]=F("isEditing",!1),A=new Set(["Neel Walse","Ashwin Chembu","David M Torres-Mendoza","Mustafa Ajmal"]),W=[],[D,J]=F("Prompt not set",""),[G,re]=F("pborderColor","#FFFFFF"),[q,K]=F("promptColor","#000000"),[_,ae]=F("widgetWidth",800),[Z,b]=F("titleFontSize",60),[B,X]=F("messageFontSize",35),[T,ee]=F("borderWidth",2);function j(t){return R(),console.log(A.has(t)),A.has(t)}function oe(){return new Promise((t,l)=>N(this,null,function*(){figma.showUI(__uiFiles__.main,{width:400,height:270}),figma.ui.onmessage=o=>N(this,null,function*(){if(o.type==="new-message"){let{message:e,anonymous:n}=o.payload;yield Fe({messageText:e,anonymous:n}),t()}else o.type==="close-plugin"&&(figma.closePlugin(),t())})}))}function Q(t){let l=t*70*Math.random();return new Promise(o=>setTimeout(o,t))}let Ce=t=>(console.log("editing"),Q(1e4),new Promise((l,o)=>{let e=p.find(n=>n.id===t);e?(console.log("opening modal"),figma.showUI(__uiFiles__.main,{width:400,height:270}),figma.ui.postMessage({type:"edit-message",payload:e.text}),console.log("opened"),figma.ui.onmessage=n=>{if(n.type==="update-message"){console.log("updated---",n.payload);let f=n.payload.message,i=n.payload.anonymous;console.log(f,i);let d=k(x({},e),{text:f,anonymous:i,edited:!0}),y=p.findIndex(m=>m.id===t);if(y!==-1){let m=[...p];m[y]=d,c(m)}figma.closePlugin(),l()}else n.type==="cancel-edit"?(console.log("canceled"),o("Edit canceled by user.")):n.type==="close-plugin"&&(console.log("closed"),figma.closePlugin(),l())}):(console.log("Message not found."),o("Message not found."))})),R=()=>{let t=figma.currentUser?figma.currentUser.name:"Unknown User";I(t),console.log(r)},de=(t=6)=>{let l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o="";for(let e=0;e<t;e++)o+=l.charAt(Math.floor(Math.random()*l.length));return o},pe=()=>{if(W.length>0){Q(1e4);let t=W.shift();t&&c(l=>[...l,t])}},Fe=t=>N(this,null,function*(){let{messageText:l,anonymous:o}=t;console.log("anonymous:",o),console.log("messageText:",l),console.log("messageData:",t);let e=10;if(R(),l.trim()!==""){let n=Date.now(),f=de(),i=`${n}${f}${r}`;console.log(i);let d=new Date(n),y=d.getHours(),m=d.getMinutes(),h=m<10?"0"+m:m.toString(),g=y>=12?"PM":"AM",U=`${y%12||12}:${h} ${g}`,S=figma.currentUser&&figma.currentUser.name?figma.currentUser.name:r,v=figma.currentUser?figma.currentUser.photoUrl:null,L={id:i,parentId:null,text:l.trim(),sender:S,timestamp:U,edited:!1,deleteConfirm:!1,showReplies:!1,pinned:!1,deleted:!1,upvotedUsers:[],downvotedUsers:[],directreply:0,logId:w,userIcon:v,anonymous:o};try{console.log("newMessage before sending:",L);let P=yield fetch("https://figjam-widgets.onrender.com/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(!P.ok)throw new Error(`HTTP error! status: ${P.status}`);let te=yield P.json();console.log("Message added successfully:",te)}catch(P){console.error("Error adding message:",P)}W.push(L),Q(1e4),pe()}}),xe=t=>{c(l=>l.map(o=>{if(o.id===t){let e=[...o.upvotedUsers],n=[...o.downvotedUsers],f=e.indexOf(r),i=n.indexOf(r);return f>-1?e.splice(f,1):(e.push(r),i>-1&&n.splice(i,1)),k(x({},o),{upvotedUsers:e,downvotedUsers:n})}return o}))},ke=t=>{c(l=>l.map(o=>{if(o.id===t){let e=[...o.upvotedUsers],n=[...o.downvotedUsers],f=e.indexOf(r),i=n.indexOf(r);return i>-1?n.splice(i,1):(n.push(r),f>-1&&e.splice(f,1)),k(x({},o),{upvotedUsers:e,downvotedUsers:n})}return o}))},ve=t=>N(this,null,function*(){let l=Date.now(),o=de(),e=`${l}${o}${r}`,n=new Date(l),f=n.getHours(),i=n.getMinutes(),d=i<10?"0"+i:i.toString(),y=f>=12?"PM":"AM",h=`${f%12||12}:${d} ${y}`,g=figma.currentUser&&figma.currentUser.name?figma.currentUser.name:r,E=figma.currentUser?figma.currentUser.photoUrl:null,U=p.find(S=>S.id===t);return U?(figma.showUI(__uiFiles__.main,{width:400,height:270}),figma.ui.postMessage({type:"reply-message",payload:U}),new Promise((S,v)=>{figma.ui.onmessage=L=>{if(L.type==="send-reply"){console.log(L.payload);let P=L.payload.message,te=L.payload.anonymous,Se={id:e,parentId:t,text:P,sender:r,timestamp:h,edited:!1,deleteConfirm:!1,showReplies:!1,pinned:!1,deleted:!1,upvotedUsers:[],downvotedUsers:[],directreply:0,logId:w,userIcon:E,anonymous:te};console.log("newreply");let je=p.map(Y=>Y.id===t?k(x({},Y),{directreply:Y.directreply+1}):Y);W.push(Se),Q(1e4),pe(),S()}else L.type==="close-plugin"&&v("Reply action was cancelled.")}})):(console.error("Message to reply to was not found."),Promise.reject("Message to reply to was not found."))}),ge=t=>{let l=p.find(o=>o.id===t);if(l){l.deleted=!0;let o=p.map(e=>e.id===t?k(x({},e),{text:"this message has been deleted",sender:"Anonymous",edited:!1,showReplies:!1}):e);c(o),V(null),$(""),ie("Type a message..."),O(!0),setTimeout(()=>O(!1),2e3)}},Me=t=>{let l=p.find(o=>o.id===t);l&&l.deleteConfirm===!1?c(o=>o.map(e=>e.id===t?k(x({},e),{deleteConfirm:!0}):e)):c(o=>o.map(e=>e.id===t?k(x({},e),{deleteConfirm:!1}):e))},_e=t=>{let l=p.find(o=>o.id===t);l&&l.showReplies===!1?c(o=>o.map(e=>e.id===t?k(x({},e),{showReplies:!0}):e)):c(o=>o.map(e=>e.id===t?k(x({},e),{showReplies:!1}):e))},be=t=>{if(!p.find(n=>n.id===t))return 0;let o=0,e=(n,f)=>{p.forEach(i=>{i.parentId===n&&e(i.id,f+1)}),f>o&&(o=f)};return e(t,0),o},ce=t=>{A.has(r)&&c(l=>l.map(o=>{if(o.id===t){let e=o.pinned!==void 0?o.pinned:!1;return k(x({},o),{pinned:!e})}return o}))},ue=(t=null)=>{let l=i=>p.filter(d=>d.parentId===i).length,o=i=>{if(R(),console.log("in options:",r),j(r))return new Promise((d,y)=>{figma.showUI(__uiFiles__.options,{width:350,height:50}),figma.ui.onmessage=m=>{if(m.type==="edit-message"){console.log("calling edit from options");let h=p.find(g=>g.id===i);h&&!h.deleted?(console.log(h.deleted),console.log("opening modal"),figma.showUI(__uiFiles__.main,{width:400,height:270}),figma.ui.postMessage({type:"edit-message",payload:h.text}),console.log("opened"),figma.ui.onmessage=g=>{if(g.type==="update-message"){console.log("updated");let E=g.payload.message,U=g.payload.anonymous;console.log(g.payload);let S=p.map(v=>v.id===i?k(x({},v),{text:E,anonymous:U,edited:!0}):v);c(S),figma.closePlugin(),d()}else g.type==="cancel-edit"?(console.log("canceled"),y("Edit canceled by user.")):g.type==="close-plugin"&&(console.log("closed"),figma.closePlugin(),d())}):(console.log("Message not found."),y("Message not found."))}else if(m.type==="edit-user"){console.log("calling edit from options");let h=p.find(g=>g.id===i);h&&!h.deleted?(console.log(h.deleted),console.log("opening modal"),figma.showUI(__uiFiles__.main,{width:400,height:270}),figma.ui.postMessage({type:"edit-message",payload:h.sender}),console.log("opened"),figma.ui.onmessage=g=>{if(g.type==="update-message"){console.log("updated");let E=g.payload.message,U=g.payload.anonymous;console.log(g.payload);let S=p.map(v=>v.id===i?k(x({},v),{sender:E,anonymous:U,edited:!0}):v);c(S),figma.closePlugin(),d()}else g.type==="cancel-edit"?(console.log("canceled"),y("Edit canceled by user.")):g.type==="close-plugin"&&(console.log("closed"),figma.closePlugin(),d())}):(console.log("Message not found."),y("Message not found."))}else m.type==="update-prompt"?(console.log("calling prompt from options"),figma.showUI(__uiFiles__.main,{width:400,height:250}),figma.ui.postMessage({type:"edit-prompt",payload:D}),console.log("opened"),figma.ui.onmessage=h=>{if(h.type==="update-message"){let g=h.payload.message;J(g),figma.closePlugin(),d()}else h.type==="cancel-edit"?(console.log("canceled"),y("Edit canceled by user.")):h.type==="close-plugin"&&(console.log("closed"),figma.closePlugin(),d())}):m.type==="delete-message"?(ge(i),d()):m.type==="pin-message"?(ce(i),d()):m.type==="close-options"&&d()}})},e=i=>{let d=p.filter(y=>y.parentId===i);return 0},n=[...p].sort((i,d)=>i.pinned&&!d.pinned?-1:!i.pinned&&d.pinned?1:0);return n.filter(i=>i.parentId===t).length===0?figma.widget.h(a,{padding:30,direction:"vertical",spacing:20,width:800,height:250,horizontalAlignItems:"center",verticalAlignItems:"center"},figma.widget.h(C,{fill:"#60666D",fontSize:36,fontWeight:500,lineHeight:20.4},"No messages yet"),figma.widget.h(C,{fill:"#8E939A",fontSize:24,lineHeight:20.4},"Send a message with the add message button below.")):n.filter(i=>i.parentId===t).map(i=>figma.widget.h(Be,{key:i.id,message:i,onReply:()=>ve(i.id),onEdit:()=>Ce(i.id),onDelete:()=>ge(i.id),onDeleteConfirm:()=>Me(i.id),onShowReplies:()=>_e(i.id),replyChain:ue(i.id),replyToId:H,user:r,getMessageDepth:be,onPin:ce,totalReplies:l(i.id),adminUsers:A,onUpvote:()=>xe(i.id),onDownvote:()=>ke(i.id),onOptionsClick:()=>o(i.id),updateUserName:()=>R(),getTotalDirectReplies:d=>e(i.id),messageFontSize:B}))},fe=()=>{if(R(),console.log("in options:",r),j(r))return new Promise((t,l)=>{figma.showUI(__uiFiles__.optionsChat,{width:400,height:100}),figma.ui.onmessage=o=>{o.type==="update-prompt"?(console.log("calling prompt from options"),figma.showUI(__uiFiles__.main,{width:400,height:250}),figma.ui.postMessage({type:"edit-prompt",payload:D}),console.log("opened"),figma.ui.onmessage=e=>{if(e.type==="update-message"){let n=e.payload.message;J(n),figma.closePlugin(),t()}else e.type==="cancel-edit"?(console.log("canceled"),l("Edit canceled by user.")):e.type==="close-plugin"&&(console.log("closed"),figma.closePlugin(),t())}):o.type==="update-width"?(console.log("calling width from options"),figma.showUI(__uiFiles__.main,{width:400,height:250}),figma.ui.postMessage({type:"edit-width",payload:_}),console.log("opened"),figma.ui.onmessage=e=>{if(e.type==="update-message"){let n=e.payload.message;ae(parseInt(n,10)),figma.closePlugin(),t()}else e.type==="cancel-edit"?(console.log("canceled"),l("Edit canceled by user.")):e.type==="close-plugin"&&(console.log("closed"),figma.closePlugin(),t())}):o.type==="update-borderWidth"?(console.log("calling width from options"),figma.showUI(__uiFiles__.main,{width:400,height:250}),figma.ui.postMessage({type:"edit-borderWidth",payload:T}),console.log("opened"),figma.ui.onmessage=e=>{if(e.type==="update-message"){let n=e.payload.message;ee(parseInt(n,10)),figma.closePlugin(),t()}else e.type==="cancel-edit"?(console.log("canceled"),l("Edit canceled by user.")):e.type==="close-plugin"&&(console.log("closed"),figma.closePlugin(),t())}):o.type==="update-titleFontSize"?(console.log("calling width from options"),figma.showUI(__uiFiles__.main,{width:400,height:250}),figma.ui.postMessage({type:"edit-titleFontSize",payload:Z}),console.log("opened"),figma.ui.onmessage=e=>{if(e.type==="update-message"){let n=e.payload.message;b(parseInt(n,10)),figma.closePlugin(),t()}else e.type==="cancel-edit"?(console.log("canceled"),l("Edit canceled by user.")):e.type==="close-plugin"&&(console.log("closed"),figma.closePlugin(),t())}):o.type==="update-borderColor"?(console.log("calling prompt from options"),figma.showUI(__uiFiles__.main,{width:400,height:250}),figma.ui.postMessage({type:"edit-borderColor",payload:G}),console.log("opened"),figma.ui.onmessage=e=>{if(e.type==="update-message"){let n=e.payload.message;re(n),figma.closePlugin(),t()}else e.type==="cancel-edit"?(console.log("canceled"),l("Edit canceled by user.")):e.type==="close-plugin"&&(console.log("closed"),figma.closePlugin(),t())}):o.type==="update-messageFontSize"?(console.log("calling prompt from options"),figma.showUI(__uiFiles__.main,{width:400,height:250}),figma.ui.postMessage({type:"edit-messageFontSize",payload:B}),console.log("opened"),figma.ui.onmessage=e=>{if(e.type==="update-message"){let n=e.payload.message;X(parseInt(n,10)),figma.closePlugin(),t()}else e.type==="cancel-edit"?(console.log("canceled"),l("Edit canceled by user.")):e.type==="close-plugin"&&(console.log("closed"),figma.closePlugin(),t())}):o.type==="update-promptColor"?(console.log("calling prompt from options"),figma.showUI(__uiFiles__.main,{width:400,height:250}),figma.ui.postMessage({type:"edit-promptColor",payload:q}),console.log("opened"),figma.ui.onmessage=e=>{if(e.type==="update-message"){let n=e.payload.message;K(n),figma.closePlugin(),t()}else e.type==="cancel-edit"?(console.log("canceled"),l("Edit canceled by user.")):e.type==="close-plugin"&&(console.log("closed"),figma.closePlugin(),t())}):o.type==="close-options"&&t()}})};return figma.widget.h(a,{direction:"vertical",spacing:8,padding:T,stroke:"#efefef",strokeWidth:2,cornerRadius:10,onClick:R,minWidth:_,fill:G},figma.widget.h(a,{direction:"vertical",spacing:8,padding:T,stroke:"#efefef",strokeWidth:2,cornerRadius:10,onClick:R,minWidth:_,fill:"#FFFFFF"},figma.widget.h(a,{cornerRadius:4,padding:{top:15,bottom:2,left:770,right:10},onClick:fe},figma.widget.h(M,{src:ye,onClick:fe})),figma.widget.h(a,{padding:{top:0,bottom:20,left:20}},figma.widget.h(C,{fill:q,fontSize:Z,fontWeight:700,width:770,lineHeight:75},D||"Chat")),figma.widget.h(a,{direction:"vertical",spacing:1,padding:8,stroke:"#efefef",cornerRadius:10,minWidth:480},ue()),figma.widget.h(a,{direction:"vertical",spacing:8,padding:8,onClick:R,horizontalAlignItems:"end",minWidth:800},figma.widget.h(a,{direction:"horizontal",onClick:oe,fill:"#007AFF",padding:10,cornerRadius:100},figma.widget.h(a,{padding:8},figma.widget.h(M,{src:He})),figma.widget.h(C,{fontSize:36,fill:"#FFFFFF"},"Add Message  ")))))}function Be({getTotalDirectReplies:w,message:s,onReply:u,onDelete:$,onEdit:H,replyChain:V,replyToId:p,user:c,onDeleteConfirm:r,getMessageDepth:I,onShowReplies:z,onPin:ie,totalReplies:ne,adminUsers:O,onUpvote:se,onDownvote:le,onOptionsClick:A,updateUserName:W,messageFontSize:D}){let J=s.parentId!==null,G=p===s.id,re=s.upvotedUsers.length,q=s.downvotedUsers.length,K=s.sender.split(" ")[0],_={fill:G?"#007AFF":"#FFFFFF",color:"#000000",extra:G?"#007AFF":"#f0f0f0"},ae=s.sender===c,Z=s.edited,b=s.deleted,B=I(s.id),X=s.upvotedUsers.length-s.downvotedUsers.length;var T=!1;console.log("USER:",c),O.has(c)&&(console.log("inside",T),T=!0);var ee=160;B==0&&(ee=160);var j=!1;B>=1&&(j=!0);var oe=!0;return s.text=="this message has been deleted"&&(oe=!1),figma.widget.h(a,{direction:"vertical"},figma.widget.h(a,{direction:"vertical",padding:{top:15,bottom:b?0:15,left:12,right:12},strokeWidth:2,cornerRadius:4,spacing:20,fill:_.fill,width:800,effect:[]},figma.widget.h(a,{direction:"horizontal",width:800,padding:{top:10,bottom:1,left:4,right:8}},figma.widget.h(a,{direction:"horizontal",horizontalAlignItems:"start",width:520,spacing:20},s.userIcon?figma.widget.h(Te,{src:s.userIcon,width:40,height:40,cornerRadius:15}):figma.widget.h(M,{src:"<svg>...<svg>",width:30,height:30}),figma.widget.h(C,{fontSize:30,fill:_.color,horizontalAlignText:"left"},s.deleted||s.anonymous?"Anonymous":K,":"),s.pinned&&figma.widget.h(M,{src:Ve})),figma.widget.h(a,{direction:"horizontal",horizontalAlignItems:"end",padding:{top:2,bottom:2,left:8,right:8},width:200},figma.widget.h(C,{fontSize:25,fill:_.color,horizontalAlignText:"right"},s.timestamp)),s.text!="this message has been deleted"&&T&&figma.widget.h(a,{cornerRadius:4,padding:{top:2,bottom:2,left:8,right:8},onClick:A},figma.widget.h(M,{src:ye,onClick:A}))),figma.widget.h(a,{direction:"horizontal",padding:{top:20,bottom:4,left:10,right:4},fill:_.fill},figma.widget.h(a,{direction:"vertical"},figma.widget.h(C,{width:740,fontSize:D},b?"this message has been deleted":s.text),figma.widget.h(C,{width:60,fontSize:4,fill:"#808080"}," "),Z&&!b&&figma.widget.h(C,{width:200,fontSize:25,fill:"#808080"},"(edited)"))),figma.widget.h(a,{direction:"horizontal",padding:{top:20,bottom:0,left:4,right:4},spacing:12},s.text!="this message has been deleted"&&figma.widget.h(a,{fill:_.extra,cornerRadius:200},figma.widget.h(a,{cornerRadius:200,padding:{top:14,bottom:4,left:10,right:10},onClick:()=>se()},figma.widget.h(C,{fontSize:25,fill:"#FFFFFF"}," "),figma.widget.h(M,{src:ze})),figma.widget.h(a,{padding:{top:10,bottom:6,left:10,right:10}},figma.widget.h(C,{fontSize:25,fill:"#000000"},X)),figma.widget.h(a,{cornerRadius:200,padding:{top:14,bottom:4,left:10,right:10},onClick:()=>le()},figma.widget.h(M,{src:De}),figma.widget.h(C,{fontSize:25,fill:"#FFFFFF"}," "))),s.text!="this message has been deleted"&&figma.widget.h(a,{fill:"#007AFF",cornerRadius:200,padding:{top:8,bottom:b?0:8,left:10,right:10},onClick:u},figma.widget.h(C,{fontSize:25,fill:"#007AFF"}," "),figma.widget.h(M,{src:Pe,onClick:u}),figma.widget.h(C,{fontSize:25,fill:"#FFFFFF"}," Reply  ")),j&&figma.widget.h(a,{cornerRadius:4,padding:{top:8,bottom:b?15:0,left:10,right:10},onClick:z},s.showReplies&&figma.widget.h(a,{cornerRadius:4,padding:{top:6,bottom:6,left:0,right:0},onClick:z},figma.widget.h(M,{src:Ge,onClick:z})),!s.showReplies&&figma.widget.h(a,{cornerRadius:4,padding:{top:6,bottom:6,left:0,right:0},onClick:z},figma.widget.h(M,{src:Ee,onClick:z})),figma.widget.h(C,{fontSize:25,fill:(s.showReplies,"#007AFF")},"  ",ne," Replies ")))),s.showReplies&&V&&figma.widget.h(a,{direction:"vertical",width:"fill-parent",padding:{top:b?0:10,bottom:b?0:10,left:32,right:8}},V))}we.register(We);})();
