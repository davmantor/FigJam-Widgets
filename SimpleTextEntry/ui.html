<!doctype html>
<meta charset="utf-8" />
<title>Admin Menu</title>
<style>
  body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; padding:12px; }
  .row { display:flex; gap:8px; align-items:center; margin-bottom:8px; }
  .row label { width:120px; font-size:12px; color:#333; }
  .row input, .row textarea { flex:1; padding:6px 8px; border:1px solid #ccc; border-radius:6px; font-size:12px; }
  .hint { font-size:11px; color:#666; margin-top:-4px; margin-bottom:8px; }
  .btns { display:flex; gap:8px; margin-top:12px; }
  button { padding:8px 12px; border-radius:6px; border:0; cursor:pointer; }
  .apply { background:#000; color:#fff; }
  .close { background:#eee; }
</style>

<div class="row"><label>Width</label><input type="number" id="width" min="200" step="10"></div>
<div class="row"><label>Height</label><input type="number" id="height" min="140" step="10"></div>
<div class="row"><label>Font size</label><input type="number" id="fontSize" min="10" step="1"></div>

<div class="row"><label>Border color</label><input type="text" id="borderColor" placeholder="#000000"></div>
<div class="row"><label>Border width</label><input type="number" id="borderWidth" min="0" step="1"></div>

<div class="row"><label>Shadow color</label><input type="text" id="shadowColor" placeholder="#0000001A"></div>
<div class="row"><label>Shadow blur</label><input type="number" id="shadowBlur" min="0" step="1"></div>
<div class="row"><label>Shadow offset X</label><input type="number" id="shadowOffsetX" step="1"></div>
<div class="row"><label>Shadow offset Y</label><input type="number" id="shadowOffsetY" step="1"></div>

<div class="row" style="align-items:flex-start">
  <label>Admins</label>
  <textarea id="admins" rows="3" placeholder="Comma-separated usernames, e.g.&#10;Alice Chen, Bob Rivera"></textarea>
</div>
<div class="hint">Anyone whose Figma username exactly matches a name in this list can open this menu.</div>

<div class="btns">
  <button class="apply" id="apply">Apply</button>
  <button class="close" id="close">Close</button>
</div>

<script>
  // receive initial values
  window.onmessage = (event) => {
    const msg = event.data && event.data.pluginMessage;
    if (!msg || msg.type !== "init") return;
    const p = msg.payload || {};
    document.getElementById("width").value = p.width ?? 420;
    document.getElementById("height").value = p.height ?? 240;
    document.getElementById("fontSize").value = p.fontSize ?? 14;
    document.getElementById("borderColor").value = p.borderColor ?? "#000000";
    document.getElementById("borderWidth").value = p.borderWidth ?? 1;
    document.getElementById("shadowColor").value = p.shadowColor ?? "#0000001A";
    document.getElementById("shadowBlur").value = p.shadowBlur ?? 8;
    document.getElementById("shadowOffsetX").value = p.shadowOffsetX ?? 0;
    document.getElementById("shadowOffsetY").value = p.shadowOffsetY ?? 2;
    document.getElementById("admins").value = (p.admins || []).join(", ");
  };

  function number(id) { return Number(document.getElementById(id).value); }
  function text(id) { return String(document.getElementById(id).value || ""); }

  document.getElementById("apply").onclick = () => {
    const adminsCSV = text("admins");
    const admins = adminsCSV.split(",").map(s => s.trim()).filter(Boolean);
    parent.postMessage({ pluginMessage: {
      type: "apply",
      payload: {
        width: number("width"),
        height: number("height"),
        fontSize: number("fontSize"),
        borderColor: text("borderColor"),
        borderWidth: number("borderWidth"),
        shadowColor: text("shadowColor"),
        shadowBlur: number("shadowBlur"),
        shadowOffsetX: number("shadowOffsetX"),
        shadowOffsetY: number("shadowOffsetY"),
        admins
      }
    }}, "*");
  };

  document.getElementById("close").onclick = () => {
    parent.postMessage({ pluginMessage: { type: "close" } }, "*");
  };
</script>
